<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>sshdump - The Wireshark Network Analyzer 2.6.3</title>
<link rel="stylesheet" href="ws.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<h1 id="NAME">NAME</h1>

<p>sshdump - Provide interfaces to capture from a remote host through SSH using a remote capture binary.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p><b>sshdump</b> <span style="white-space: nowrap;">[ <b>--help</b> ]</span> <span style="white-space: nowrap;">[ <b>--version</b> ]</span> <span style="white-space: nowrap;">[ <b>--extcap-interfaces</b> ]</span> <span style="white-space: nowrap;">[ <b>--extcap-dlts</b> ]</span> <span style="white-space: nowrap;">[ <b>--extcap-interface</b>=&lt;interface&gt; ]</span> <span style="white-space: nowrap;">[ <b>--extcap-config</b> ]</span> <span style="white-space: nowrap;">[ <b>--extcap-capture-filter</b>=&lt;capture filter&gt; ]</span> <span style="white-space: nowrap;">[ <b>--capture</b> ]</span> <span style="white-space: nowrap;">[ <b>--fifo</b>=&lt;path to file or pipe&gt; ]</span> <span style="white-space: nowrap;">[ <b>--remote-host</b>=&lt;IP address&gt; ]</span> <span style="white-space: nowrap;">[ <b>--remote-port</b>=&lt;TCP port&gt; ]</span> <span style="white-space: nowrap;">[ <b>--remote-username</b>=&lt;username&gt; ]</span> <span style="white-space: nowrap;">[ <b>--remote-password</b>=&lt;password&gt; ]</span> <span style="white-space: nowrap;">[ <b>--sshkey</b>=&lt;public key path&lt;gt</span> ]&gt; <span style="white-space: nowrap;">[ <b>--remote-interface</b>=&lt;interface&gt; ]</span> <span style="white-space: nowrap;">[ <b>--remote-capture-command</b>=&lt;capture command&gt; ]</span></p>

<p><b>sshdump</b> <span style="white-space: nowrap;"><b>--extcap-interfaces</b></span></p>

<p><b>sshdump</b> <span style="white-space: nowrap;"><b>--extcap-interface</b>=&lt;interface&gt;</span> <span style="white-space: nowrap;"><b>--extcap-dlts</b></span></p>

<p><b>sshdump</b> <span style="white-space: nowrap;"><b>--extcap-interface</b>=&lt;interface&gt;</span> <span style="white-space: nowrap;"><b>--extcap-config</b></span></p>

<p><b>sshdump</b> <span style="white-space: nowrap;"><b>--extcap-interface</b>=&lt;interface&gt;</span> <span style="white-space: nowrap;"><b>--fifo</b>=&lt;path to file or pipe&gt;</span> <span style="white-space: nowrap;"><b>--capture</b></span> <span style="white-space: nowrap;"><b>--remote-host=myremotehost</b></span> <span style="white-space: nowrap;"><b>--remote-port=22</b></span> <span style="white-space: nowrap;"><b>--remote-username=user</b></span> <span style="white-space: nowrap;"><b>--remote-interface=eth2</b></span> <span style="white-space: nowrap;"><b>--remote-capture-command=&#39;tcpdump -U -i eth0 -w-&#39;</b></span></p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p><b>Sshdump</b> is a extcap tool that allows one to run a remote capture tool in a SSH connection. The requirement is that the capture executable must have the capabilities to capture from the wanted interface.</p>

<p>The feature is functionally equivalent to run commands like</p>

<p>$ ssh remoteuser@remotehost -p 22222 &#39;tcpdump -U -i IFACE -w -&#39; &gt; FILE &amp; $ wireshark FILE</p>

<p>$ ssh remoteuser@remotehost &#39;/sbin/dumpcap -i IFACE -P -w - -f &quot;not port 22&quot;&#39; &gt; FILE &amp; $ wireshark FILE</p>

<p>Supported interfaces:</p>

<dl>

<dt id="ssh">1. ssh</dt>
<dd>

</dd>
</dl>

<h1 id="OPTIONS">OPTIONS</h1>

<dl>

<dt id="help">--help</dt>
<dd>

<p>Print program arguments.</p>

</dd>
<dt id="version">--version</dt>
<dd>

<p>Print program version.</p>

</dd>
<dt id="extcap-interfaces">--extcap-interfaces</dt>
<dd>

<p>List available interfaces.</p>

</dd>
<dt id="extcap-interface-interface">--extcap-interface=&lt;interface&gt;</dt>
<dd>

<p>Use specified interfaces.</p>

</dd>
<dt id="extcap-dlts">--extcap-dlts</dt>
<dd>

<p>List DLTs of specified interface.</p>

</dd>
<dt id="extcap-config">--extcap-config</dt>
<dd>

<p>List configuration options of specified interface.</p>

</dd>
<dt id="capture">--capture</dt>
<dd>

<p>Start capturing from specified interface and write raw packet data to the location specified by --fifo.</p>

</dd>
<dt id="fifo-path-to-file-or-pipe">--fifo=&lt;path to file or pipe&gt;</dt>
<dd>

<p>Save captured packet to file or send it through pipe.</p>

</dd>
<dt id="remote-host-remote-host">--remote-host=&lt;remote host&gt;</dt>
<dd>

<p>The address of the remote host for capture.</p>

</dd>
<dt id="remote-port-remote-port">--remote-port=&lt;remote port&gt;</dt>
<dd>

<p>The SSH port of the remote host.</p>

</dd>
<dt id="remote-username-username">--remote-username=&lt;username&gt;</dt>
<dd>

<p>The username for ssh authentication.</p>

</dd>
<dt id="remote-password-password">--remote-password=&lt;password&gt;</dt>
<dd>

<p>The password to use (if not ssh-agent and pubkey are used). WARNING: the passwords are stored in plaintext and visible to all users on this system. It is recommended to use keyfiles with a SSH agent.</p>

</dd>
<dt id="sshkey-SSH-private-key-path">--sshkey=&lt;SSH private key path&gt;</dt>
<dd>

<p>The path to a private key for authentication.</p>

</dd>
<dt id="remote-interface-remote-interface">--remote-interface=&lt;remote interface&gt;</dt>
<dd>

<p>The remote network interface to capture from.</p>

</dd>
<dt id="remote-capture-command-capture-command">--remote-capture-command=&lt;capture command&gt;</dt>
<dd>

<p>A custom remote capture command that produces the remote stream that is shown in Wireshark. The command must be able to produce a PCAP stream written to STDOUT. See below for more examples.</p>

</dd>
<dt id="extcap-capture-filter-capture-filter">--extcap-capture-filter=&lt;capture filter&gt;</dt>
<dd>

<p>The capture filter</p>

</dd>
</dl>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>To see program arguments:</p>

<pre><code>    sshdump --help</code></pre>

<p>To see program version:</p>

<pre><code>    sshdump --version</code></pre>

<p>To see interfaces:</p>

<pre><code>    sshdump --extcap-interfaces</code></pre>

<p>Only one interface (ssh) is supported.</p>

<pre><code>  <span class="variable">Output</span><span class="operator">:</span>
    <span class="variable">interface</span> <span class="operator">{</span><span class="variable">value</span><span class="operator">=</span><span class="variable">ssh</span><span class="operator">}</span><span class="operator">{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">SSH</span> <span class="variable">remote</span> <span class="variable">capture</span><span class="operator">}</span>
</code></pre>

<p>To see interface DLTs:</p>

<pre><code>    <span class="variable">sshdump</span> <span class="operator">--</span><span class="variable">extcap</span><span class="operator">-</span><span class="variable">interface</span><span class="operator">=</span><span class="variable">ssh</span> <span class="operator">--</span><span class="variable">extcap</span><span class="operator">-</span><span class="variable">dlts</span>
    
      <span class="variable">Output</span><span class="operator">:</span>
    <span class="variable">dlt</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">147</span><span class="operator">}</span><span class="operator">{</span><span class="variable">name</span><span class="operator">=</span><span class="variable">ssh</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">capture</span> <span class="variable">dependent</span> <span class="variable">DLT</span><span class="operator">}</span>
</code></pre>

<p>To see interface configuration options:</p>

<pre><code>    <span class="variable">sshdump</span> <span class="operator">--</span><span class="variable">extcap</span><span class="operator">-</span><span class="variable">interface</span><span class="operator">=</span><span class="variable">ssh</span> <span class="operator">--</span><span class="variable">extcap</span><span class="operator">-</span><span class="variable">config</span>
    
      <span class="variable">Output</span><span class="operator">:</span>
    
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">0</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">host</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">SSH</span> <span class="variable">server</span> <span class="variable">address</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">SSH</span> <span class="variable">host</span><span class="operator">.</span> <span class="variable">It</span> <span class="variable">can</span> <span class="variable">be</span> <span class="variable">both</span> <span class="variable">an</span> <span class="variable">IP</span> <span class="variable">address</span> <span class="keyword">or</span> <span class="variable">a</span> <span class="variable">hostname</span><span class="operator">}{</span><span class="variable">required</span><span class="operator">=</span><span class="variable">true</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">1</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">port</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">SSH</span> <span class="variable">server</span> <span class="variable">port</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">unsigned</span><span class="operator">}</span>
        <span class="operator">{</span><span class="keyword">default</span><span class="operator">=</span><span class="number">22</span><span class="operator">}{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">SSH</span> <span class="variable">host</span> <span class="variable">port</span> <span class="operator">(</span><span class="number">1</span><span class="operator">-</span><span class="number">65535</span><span class="operator">)</span><span class="operator">}{</span><span class="variable">range</span><span class="operator">=</span><span class="number">1</span><span class="operator">,</span><span class="number">65535</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">2</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">username</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">SSH</span> <span class="variable">server</span> <span class="variable">username</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}</span>
        <span class="operator">{</span><span class="keyword">default</span><span class="operator">=</span><span class="variable">myusername</span><span class="operator">}{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">SSH</span> <span class="variable">username</span><span class="operator">.</span> <span class="variable">If</span> <span class="keyword">not</span> <span class="variable">provided</span><span class="operator">,</span> <span class="variable">the</span> <span class="variable">current</span> <span class="variable">user</span> <span class="variable">will</span> <span class="variable">be</span> <span class="variable">used</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">3</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">password</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">SSH</span> <span class="variable">server</span> <span class="variable">password</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">password</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">SSH</span> <span class="variable">password</span><span class="operator">,</span> <span class="variable">used</span> <span class="keyword">when</span> <span class="variable">other</span> <span class="variable">methods</span> <span class="operator">(</span><span class="variable">SSH</span> <span class="variable">agent</span> <span class="keyword">or</span> <span class="variable">key</span> <span class="variable">files</span><span class="operator">)</span> <span class="variable">are</span> <span class="variable">unavailable</span><span class="operator">.</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">4</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">sshkey</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Path</span> <span class="variable">to</span> <span class="variable">SSH</span> <span class="variable">private</span> <span class="variable">key</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">fileselect</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">path</span> <span class="variable">on</span> <span class="variable">the</span> <span class="keyword">local</span> <span class="variable">filesystem</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">private</span> <span class="variable">ssh</span> <span class="variable">key</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">5</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">sshkey</span><span class="operator">-</span><span class="variable">passphrase</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">SSH</span> <span class="variable">key</span> <span class="variable">passphrase</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">Passphrase</span> <span class="variable">to</span> <span class="variable">unlock</span> <span class="variable">the</span> <span class="variable">SSH</span> <span class="variable">private</span> <span class="variable">key</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">6</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">interface</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">interface</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}{</span><span class="keyword">default</span><span class="operator">=</span><span class="variable">eth0</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">network</span> <span class="variable">interface</span> <span class="variable">used</span> <span class="keyword">for</span> <span class="variable">capture</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">7</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">capture</span><span class="operator">-</span><span class="variable">command</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">capture</span> <span class="variable">command</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">command</span> <span class="variable">used</span> <span class="variable">to</span> <span class="variable">capture</span><span class="operator">.</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">8</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">filter</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Remote</span> <span class="variable">capture</span> <span class="variable">filter</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">string</span><span class="operator">}</span>
        <span class="operator">{</span><span class="keyword">default</span><span class="operator">=</span><span class="keyword">not</span> <span class="operator">((</span><span class="variable">host</span> <span class="variable">myip</span><span class="operator">)</span> <span class="keyword">and</span> <span class="variable">port</span> <span class="number">22</span><span class="operator">)</span><span class="operator">}{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">remote</span> <span class="variable">capture</span> <span class="variable">filter</span><span class="operator">}</span>
    <span class="variable">arg</span> <span class="operator">{</span><span class="variable">number</span><span class="operator">=</span><span class="number">9</span><span class="operator">}</span><span class="operator">{</span><span class="variable">call</span><span class="operator">=--</span><span class="variable">remote</span><span class="operator">-</span><span class="variable">count</span><span class="operator">}{</span><span class="variable">display</span><span class="operator">=</span><span class="variable">Packets</span> <span class="variable">to</span> <span class="variable">capture</span><span class="operator">}{</span><span class="variable">type</span><span class="operator">=</span><span class="variable">unsigned</span><span class="operator">}{</span><span class="keyword">default</span><span class="operator">=</span><span class="number">0</span><span class="operator">}</span>
        <span class="operator">{</span><span class="variable">tooltip</span><span class="operator">=</span><span class="variable">The</span> <span class="variable">number</span> <span class="variable">of</span> <span class="variable">remote</span> <span class="variable">packets</span> <span class="variable">to</span> <span class="variable">capture</span><span class="operator">.</span> <span class="operator">(</span><span class="variable">Default</span><span class="operator">:</span> <span class="variable">unlimited</span><span class="operator">)</span><span class="operator">}</span>
</code></pre>

<p>To capture:</p>

<pre><code>    sshdump --extcap-interface=ssh --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
    --remote-username user --remote-filter &quot;not port 22&quot;</code></pre>

<p>To use different capture binaries:</p>

<pre><code>    sshdump --extcap-interface=ssh --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
    --remote-capture-command=&#39;dumpcap -i eth0 -P -w -&#39;

    sshdump --extcap-interface=ssh --fifo=/tmp/ssh.pcap --capture --remote-host 192.168.1.10
    --remote-capture-command=&#39;sudo tcpdump -i eth0 -U -w -&#39;</code></pre>

<p>NOTE: To stop capturing CTRL+C/kill/terminate application.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p>wireshark(1), tshark(1), dumpcap(1), extcap(4), tcpdump(1)</p>

<h1 id="NOTES">NOTES</h1>

<p><b>Sshdump</b> is part of the <b>Wireshark</b> distribution. The latest version of <b>Wireshark</b> can be found at <a href="https://www.wireshark.org">https://www.wireshark.org</a>.</p>

<p>HTML versions of the Wireshark project man pages are available at: <a href="https://www.wireshark.org/docs/man-pages">https://www.wireshark.org/docs/man-pages</a>.</p>

<h1 id="AUTHORS">AUTHORS</h1>

<pre><code>  Original Author
  -------- ------
  Dario Lombardo             &lt;lomato[AT]gmail.com&gt;</code></pre>


</body>

</html>


